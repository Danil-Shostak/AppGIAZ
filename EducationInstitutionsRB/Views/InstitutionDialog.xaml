<ContentDialog
    x:Class="EducationInstitutionsRB.Views.InstitutionDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:EducationInstitutionsRB.Converters"
    Title="{x:Bind Title}"
    PrimaryButtonText="Сохранить"
    CloseButtonText="Отмена"
    PrimaryButtonClick="ContentDialog_PrimaryButtonClick"
    DefaultButton="Primary"
    mc:Ignorable="d">

    <ContentDialog.Resources>
        <converters:DateTimeToDateTimeOffsetConverter x:Key="DateTimeToDateTimeOffsetConverter"/>
    </ContentDialog.Resources>

    <!-- Скролл у края, без отступов -->
    <ScrollViewer MaxHeight="500" VerticalScrollBarVisibility="Auto"
                  HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch"
                  Padding="16"
                  Margin="16">
        <!-- Контент с отступами только справа для скролла -->
        <StackPanel Spacing="16" Padding="0, 0, 16, 0" HorizontalAlignment="Stretch"
                    Margin="0">
            <TextBlock Text="Поля, отмеченные *, обязательны для заполнения" 
                       FontStyle="Italic" Foreground="Gray" FontSize="12"
                       />

            <!-- Основная информация -->
            <TextBox Header="Название *" 
                     Text="{x:Bind Institution.Name, Mode=TwoWay}"
                     PlaceholderText="Введите название учреждения"
                     HorizontalAlignment="Stretch"
                     Margin="16,0,0,0"/>

            <ComboBox Header="Тип *" 
                      ItemsSource="{x:Bind InstitutionTypes}" 
                      SelectedItem="{x:Bind Institution.Type, Mode=TwoWay}"
                      PlaceholderText="Выберите тип учреждения"
                      HorizontalAlignment="Stretch"
                      Margin="16,0,0,0"/>

            <TextBox Header="Адрес *" 
                     Text="{x:Bind Institution.Address, Mode=TwoWay}"
                     PlaceholderText="Введите адрес учреждения"
                     HorizontalAlignment="Stretch"
                     Margin="16,0,0,0"/>

            <TextBox Header="Контакты" 
                     Text="{x:Bind Institution.Contacts, Mode=TwoWay}"
                     PlaceholderText="Введите контактную информацию"
                     HorizontalAlignment="Stretch"
                     Margin="16,0,0,0"/>

            <!-- Регион и район -->
            <ComboBox Header="Область *" 
                      x:Name="RegionCombo"
                      DisplayMemberPath="Name"
                      SelectedValuePath="Id"
                      SelectionChanged="RegionCombo_SelectionChanged"
                      PlaceholderText="Выберите область"
                      HorizontalAlignment="Stretch"
                      Margin="16,0,0,0"/>

            <ComboBox Header="Район *" 
                      x:Name="DistrictCombo"
                      DisplayMemberPath="Name"
                      SelectedValuePath="Id"
                      SelectionChanged="DistrictCombo_SelectionChanged"
                      PlaceholderText="Сначала выберите область"
                      IsEnabled="False"
                      HorizontalAlignment="Stretch"
                      Margin="16,0,0,0"/>

            <!-- Статистика -->
            <TextBlock Text="Статистика" FontWeight="SemiBold" FontSize="14"
                       Margin="16,0,0,0"/>

            <Grid ColumnDefinitions="*,*" ColumnSpacing="12" Margin="16,0,0,0">
                <TextBox Grid.Column="0" 
                         Header="Количество учащихся" 
                         Text="{x:Bind Institution.StudentCount, Mode=TwoWay}"
                         PlaceholderText="0"
                         HorizontalAlignment="Stretch"/>
                <TextBox Grid.Column="1" 
                         Header="Количество персонала" 
                         Text="{x:Bind Institution.StaffCount, Mode=TwoWay}"
                         PlaceholderText="0"
                         HorizontalAlignment="Stretch"/>
            </Grid>

            <Grid ColumnDefinitions="*,*" ColumnSpacing="12" Margin="16,0,0,0">
                <TextBox Grid.Column="0" 
                         Header="Принято учащихся" 
                         Text="{x:Bind Institution.AdmittedCount, Mode=TwoWay}"
                         PlaceholderText="0"
                         HorizontalAlignment="Stretch"/>
                <TextBox Grid.Column="1" 
                         Header="Отчислено учащихся" 
                         Text="{x:Bind Institution.ExpelledCount, Mode=TwoWay}"
                         PlaceholderText="0"
                         HorizontalAlignment="Stretch"/>
            </Grid>

            <!-- Статус и дата -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="12" Margin="16,0,0,0">
                <ComboBox Grid.Column="0" 
                          Header="Статус" 
                          ItemsSource="{x:Bind StatusTypes}" 
                          SelectedItem="{x:Bind Institution.Status, Mode=TwoWay}"
                          HorizontalAlignment="Stretch"/>

                <DatePicker Grid.Column="1" 
                            Header="Дата регистрации" 
                            Date="{x:Bind Institution.RegistrationDate, Mode=TwoWay, Converter={StaticResource DateTimeToDateTimeOffsetConverter}}"
                            HorizontalAlignment="Stretch"/>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</ContentDialog>